module core;

type Iterator[+T] {
  Maybe[T] next();

  Bool hasNext() {
    return this.next().isSomething();
  }
}

type EmptyIterator[+T] extends Iterator[T] {
  Maybe[T] next() {
    return new None[T]();
  }
}

type SingletonIterator[+T] extends Iterator[T] {
  T value;
  Bool used;

  Maybe[T] next() {
    if (this.used)
      new None[T]();
    else {
      this.used = true;
      return new Some[T](this.value);
    }
  }
}
